"use strict";var app=angular.module("adneomNews",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/news/:idNews",{templateUrl:"views/show-news.html",controller:"showNewsCtrl",controllerAs:"showNews"}).otherwise({redirectTo:"/"})}]);app.controller("MainCtrl",["$scope","Post",function(a,b){a.postForm=!1,a.posts=b.query()}]),app.controller("showNewsCtrl",["$scope","$routeParams","$log","Post",function(a,b,c,d){a.post=d.get({_id:b.idNews}),a.postUpvoted=!1,a.saveComment=function(){d.addComment({_id:a.post._id},a.comment,function(b){a.post.comments.push(b),a.comment=null,a.addCommentForm.$setPristine()})},a.upvote=function(){0==a.postUpvoted&&d.upvote({_id:a.post._id},function(){a.post.upvotes++,a.postUpvoted=!0})}}]),app.factory("Post",["$resource",function(a){return a("http://adneom.herokuapp.com/api/posts/:_id",{_id:"@_id"},{upvote:{method:"PUT",url:"http://adneom.herokuapp.com/api/posts/:_id/:action",params:{_id:"@_id",action:"upvote"}},addComment:{method:"POST",url:"http://adneom.herokuapp.com/api/posts/:_id/comments"}})}]),app.directive("anPostList",function(){return{restrict:"E",templateUrl:"views/directives/post-list.html"}}),app.directive("anPostForm",function(){return{restrict:"E",templateUrl:"views/directives/post-form.html",scope:!0,controller:["$scope","$log","Post",function(a,b,c){a.savePost=function(b){c.save(b,function(b){a.posts.push(b),a.post=null,a.addPostForm.$setPristine,a.postForm=!1})}}]}}),angular.module("adneomNews").run(["$templateCache",function(a){a.put("views/directives/post-form.html",'<form class="add-post-form" name="addPostForm" ng-submit="savePost(post)"> <span class="title">Ajouter une news</span><i ng-click="postForm = !postForm" class="pointer fa fa-close pull-right"></i> <input required type="text" placeholder="Titre" ng-model="post.title"><br> <input required type="url" placeholder="Lien" ng-model="post.link"><br> <input type="submit" value="Envoyer"> </form>'),a.put("views/directives/post-list.html",'<div class="post-container"> <div class="post-info"> <div class="title"> <a href="#/news/{{ post._id }}">{{ post.title || post.link }}</a> </div> <div class="link"> <a href="{{ post.link }}" target="_blank">{{ post.link }} <i class="fa fa-external-link"></i></a> </div> </div> <div class="post-aside"> <i class="fa fa-thumbs-up"></i> <span class="nb-upvotes">{{ post.upvotes }}</span> <i class="fa fa-comment"></i> <span class="nb-comments">{{ post.comments.length }}</span> </div> </div>'),a.put("views/main.html",'<div class="posts-container row"> <div><a><span ng-click="postForm = true" class="button pointer"><i class="fa fa-plus"></i> Créer une news</span></a></div> <ul ng-if="posts.length > 0" class="list-inline"> <li ng-repeat="post in posts" ng-if="post.link" class="post-item col-xs-12 col-md-4"> <an-post-list></an-post-list> </li> </ul> <div class="ng-cloak" ng-if="posts.length < 1"> Aucune news enregistrée :( </div> <div class="centered"> <an-post-form ng-if="postForm" class="animate-slide"></an-post-form> </div> </div>'),a.put("views/show-news.html",'<div class="show-news"> <div class="post-details"> <div class="title"> {{ post.title }} </div> <div class="link"> <a href="{{ post.link }}" target="_blank"> <i class="fa fa-external-link"></i> {{ post.link }}</a> </div> <div class="upvote"> <i class="fa pointer" ng-click="upvote()" ng-class="{true: \'post-upvoted fa-thumbs-up\', false: \'fa-thumbs-o-up\'}[postUpvoted]"></i> <span class="upvote-number">{{ post.upvotes }}</span> </div> </div> <div class="comments-container"> <div class="title subtitle">Commentaires</div> <ul ng-if="post.comments.length > 0" class="comments-list list-unstyled"> <li class="comment-container" ng-repeat="comment in post.comments"> <div class="comment-author">{{ comment.author }} :</div> <div class="comment-body">{{ comment.body }}</div> </li> </ul> <div ng-if="post.comments.length < 1"> Pas encore de commentaires ! </div> <form name="addCommentForm" class="form-comments" ng-submit="saveComment()"> <div class="title subtitle">Ajouter un commentaire</div> <input required type="text" placeholder="Pseudo" ng-model="comment.author"><br> <textarea required placeholder="Commentaire" ng-model="comment.body"></textarea><br> <input type="submit" value="Envoyer"> </form> </div> </div>')}]);